<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Attempting to Spoof an iPod with an OrangePi Zero - Nadav Ami</title>
  <meta name="description" content="Part 3 in a series on spoofing an iPod for car stereo shenanigans.">
  <link rel="canonical" href="https://nadav.ca/2021/03/06/car-stereo-part-3/">
  <meta property="og:title" content="Attempting to Spoof an iPod with an OrangePi Zero">
  <meta property="og:description" content="Part 3 in a series on spoofing an iPod for car stereo shenanigans.">
  <meta property="og:url" content="https://nadav.ca/2021/03/06/car-stereo-part-3/">
  <meta property="og:site_name" content="Nadav Ami">
  <meta property="og:type" content="article">
  <meta  property="article:author" content="https://nadav.ca/about/">
  <meta property="article:published_time" content="2021-03-06T21:30:00+00:00">
  <meta property="article:modified_time" content="2025-09-30T21:05:01+00:00">
  <meta property="og:image" content="https://i.ytimg.com/vi/9rhg50xrdAg/maxresdefault.jpg">
  <link rel="stylesheet" href="/styles.css">
  <link rel="alternate" type="application/atom+xml" title="Nadav Ami" href="/atom.xml">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8KGQRKWX3K"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-8KGQRKWX3K');
  </script>
</head>

  <body>
    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title"><a href="/" title="Home">Nadav Ami</a></h3>
        <hr>
      </header>

      <main>
        <article class="post">
  <h1 class="post-title" id="attempting-to-spoof-an-ipod-with-an-orangepi-zero">Attempting to Spoof an iPod with an OrangePi Zero</h1>
  <time datetime="2021-03-06T21:30:00+00:00" class="post-date">March 06, 2021</time>
  <p><em>This is the third part of a series on spoofing an iPod for car stereo shenanigans. You can find <a href="/2021/01/29/car-stereo-part-1/">part 1 here</a> or <a href="/2021/02/11/car-stereo-part-2/">part 2 here</a>.</em></p>

<p>In the previous part, I found out that my car stereo is trying to talk to an iPod over serial. Here I will cover my first attempt at bridging that serial connection with my phone via bluetooth. I’ll mostly be focusing on what went wrong, but feel free to <a href="https://github.com/nadavami/iAP-to-AVRCP" target="_blank" rel="noopener">dig through the code</a> if you want all the details.</p>

<p>First a few basics to get out of the way. iPods of the era communicate over Apple’s iPod Accessory Protocol. There <a href="http://www.ipodlinux.org/Apple_Accessory_Protocol/" target="_blank" rel="noopener">have been some attempts</a> to reverse engineer this protocol, but unfortunately the only way to get the full documentation is to join Apple’s MFI program. That said, if you look hard enough you might be able to find more specifications, but I’m not saying I did or you that you should…</p>

<p>The second piece of the puzzle is bluetooth. For this project there are two bluetooth profiles that are important, <a href="https://en.wikipedia.org/wiki/List_of_Bluetooth_profiles#Audio/Video_Remote_Control_Profile_(AVRCP)" target="_blank" rel="noopener">Audio/Video Remote Control Profile (AVRCP)</a> and <a href="https://en.wikipedia.org/wiki/List_of_Bluetooth_profiles#Advanced_Audio_Distribution_Profile_(A2DP)" target="_blank" rel="noopener">Advanced Audio Distribution Profile (A2DP)</a>. Without going into too much detail (because I don’t really understand them), AVRCP is how to control and get media info from the connected device and A2DP is how to get the actual audio stream.</p>

<p>Putting both pieces together, I made something that looks like this <img class="emoji" title=":point_down:" alt=":point_down:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f447.png" height="20" width="20">.</p>

<p class="youtube">
  <iframe src="https://www.youtube-nocookie.com/embed/9rhg50xrdAg" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</p>

<p>The demo is short (and buggy!) but there’s quite a lot going on, so I’ll break it down.</p>
<ol>
  <li>Yes, I’m parked in the street and I get as many weird looks as you might expect someone to be hacking his car would get.</li>
  <li>The audio quality is terrible. That’s not an artifact of recording but noise on the Pi’s analog audio output. A USB soundcard would probably fix this.</li>
  <li>When I hit the up button on the steering wheel (at around the 10s mark), it restarts the song. If you have eagle eyes, you’ll see the time counter to the right of the artist name restarting.</li>
  <li>Pressing on the button again goes to the previous song, but doesn’t update the track info.</li>
</ol>

<p>There are a also few other things that make this just about unusable.</p>
<ol>
  <li>The Pi takes about 45 seconds to a minute to boot. The car detects an “iPod” right when it starts and times out on connecting to it before the Pi is ready to respond to commands. In practice, this means starting the car waiting for the Pi to boot and then trying to go back into the iPod mode.</li>
  <li>There’s no easy way to pair/reconnect a bluetooth device. If my phone doesn’t connect, I’m SOL.</li>
  <li>Every so often, the car will see an “iPod” but no audio comes out even though the phone is connected. 9 times out of 10, this is because the audio stack has crashed.</li>
</ol>

<p>So to how to wrap this up? I built a thing! It works - but not well enough to be useful.</p>

<p>There are still a few things I’d like to try to get this working but some of them require taking trim pieces off the dash. Since it’s still winter, I’ll have to hold off until the weather gets a bit warmer. Should be just enough time for me to build up the courage… <img class="emoji" title=":upside_down_face:" alt=":upside_down_face:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f643.png" height="20" width="20"></p>

</article>
<p>
  <small>
    <em>Found a mistake? <a href="https://github.com/nadavami/nadavami.github.io/edit/main/_posts/2021-03-06-car-stereo-part-3.md" target="_blank" rel="noopener">Submit a PR!</a></em>
  </small>
</p>
      </main>

      <footer>
  <hr>
  <small>
    Made in <a href="https://en.wikipedia.org/wiki/Montreal" title="Montreal" target="_blank" rel="noopener">MTL</a> with love by <a href="/about/" title="who is this guy?">Nadav Ami</a>.<br>
    <small class="license">
      <a href="/license/#license">License</a> and <a href="/license/#disclaimer">Disclaimer</a>.
    </small>
  </small>
</footer>

    </div>
  </body>
</html>